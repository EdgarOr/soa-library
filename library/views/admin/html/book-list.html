<!doctype html>
<html ng-app="demo">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/bower_components/bootstrap-select/dist/css/bootstrap-select.min.css">
    <link href="/public/css/custom.css" rel="stylesheet">

    <script src="/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="/bower_components/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="/bower_components/angular/angular.min.js"></script>
    <script src="/public/js/book-list.js"></script>
    <style>
        article {
            min-height: 450px;
            
        }
    </style>
</head>

<body ng-controller="controller">
    <div class="container-fluid">
        <!-- SESSION BAR -->
        <header class="row">
            <div class="col-sm-12 nopadding">
                <div class="navbar navbar-inverse">
                    <div class="container-fluid">
                        <div class="navbar-header">
                            <button class="navbar-toggle" data-toggle="collapse" data-target="#sessionBar"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="#">LIBRARIAN APP</a> </div>
                        <div class="collapse navbar-collapse" id="sessionBar">
                            <ul class="nav navbar-nav navbar-right">
                                <li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
                                <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- BOTTOM BAR -->
        <div class="btn-group btn-group-justified navbar-fixed-bottom panel panel-default visible-xs visible-sm">
            <div class="dropup btn"> <a href="#" class="dropdown-toggle" id="dropdownBook" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><h3 style="margin:0px;" ><span class="glyphicon glyphicon-book"></span></h3> </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownBook">
                    <li class="dropdown-header">Book</li>
                    <li><a href="/admin/book/list">Consult</a></li>
                    <li><a href="/admin/book/new">Add</a></li>
                </ul>
            </div>
            <div class="dropup btn"> <a href="#" class="dropdown-toggle" id="dropdownCategory" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><h3 style="margin:0px;"><span class="glyphicon glyphicon-tags"></span></h3>
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownCategory">
                    <li class="dropdown-header">Category</li>
                    <li><a href="/admin/category/list">Consult</a></li>
                    <li><a href="/admin/category/new">Add</a></li>
                </ul>
            </div>
            <div class="dropup btn"> <a href="#" class="dropdown-toggle" id="dropdownUser" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><h3 style="margin:0px;"><span class="glyphicon glyphicon-user"></span></h3> </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownUser">
                    <li class="dropdown-header">User</li>
                    <li><a href="/admin/user/list">Consult</a></li>
                    <li><a href="/admin/user/new">Add</a></li>
                    <li><a href="#">Lend a book</a></li>
                </ul>
            </div>
            <div class="btn dropup"> <a href="#" lass="dropdown-toggle" id="dropdownLending" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><h3 style="margin:0px;"><span class="glyphicon glyphicon-time"></span></h3> </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownLending">
                    <li class="dropdown-header">Lenginds</li>
                    <li><a href="#">Consult</a></li>
                    <li><a href="#">Add</a></li>
                </ul>
            </div>
        </div>
        <!-- SIDEBAR -->
        <aside class="col-md-2 hiden-xs">
            <div class="panel panel-default panel-group visible-md visible-lg sidebar" id="accordion">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse1">Book</a>
        </h4> </div>
                    <div id="collapse1" class="panel-collapse collapse">
                        <ul class="list-group panel-body nopadding">
                            <li class="list-group-item"><a href="/admin/book/new" class="btn-block">Add</a></li>
                            <li class="list-group-item"><a href="/admin/book/list" class="btn-block">Consult</a></li>
                        </ul>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse2">Category</a>
        </h4> </div>
                    <div id="collapse2" class="panel-collapse collapse">
                        <ul class="list-group panel-body nopadding">
                            <li class="list-group-item"><a href="/admin/category/new" class="btn-block">Add</a></li>
                            <li class="list-group-item"><a href="/admin/category/list" class="btn-block">Consult</a></li>
                        </ul>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse3">User</a>
        </h4> </div>
                    <div id="collapse3" class="panel-collapse collapse">
                        <ul class="list-group panel-body nopadding">
                            <li class="list-group-item"><a href="/admin/user/new" class="btn-block">Add</a></li>
                            <li class="list-group-item"><a href="/admin/user/list" class="btn-block">Consult</a></li>
                            <li class="list-group-item"><a href="/admin/user/lending" class="btn-block">Lend a book</a></li>
                        </ul>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse4">Lending</a>
        </h4> </div>
                    <div id="collapse4" class="panel-collapse collapse">
                        <ul class="list-group panel-body nopadding">
                            <!--<li class="list-group-item"><a href="#" class="btn-block">Add</a></li>-->
                            <li class="list-group-item"><a href="#" class="btn-block">Consult</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </aside>


        <!-- MAIN CONTENT AREA -->
        <main class="col-xs-12 col-md-10 fill overflow panel panel-default" >
            <div class="jumbotron">
                <h1>Catalog of Books</h1></div>
                
                <div class="row">
                <div class="col-sm-4">
                <form class="well">
                    <input type="text" class="form-control" placeholder="Enter a category to filter" ng-model="category"/>
                </form>    
                </div>
                <div class="col-sm-8">
                        <h2> Filtering by category: <span ng-bind="category || 'None'"></span></h2>
                        </div>
                </div>
                
            <div id="content-panel" class="row panel-body">
                <article id="book-card" ng-repeat="book in books | filter : category" class="article col-xs-12 col-sm-4 col-md-4 ">
                    <div class="panel panel-default">
                        <header class="panel-heading">
                            <div class="row">
                                <div class="col-xs-10"><strong>ISBN: {{book.isbn}}</strong></div>
                                <div class="col-xs-2"> 
                                <div class="dropdown">
                                <span class="glyphicon glyphicon-option-vertical pull-right options-menu dropdown-toggle" 
                                data-toggle="dropdown"></span>
                                <ul class="dropdown-menu">
                                    <li><a href='#' data-toggle='modal' data-target='#modal' ng-click='setBookDataToModal(book.title, book._id);'>Add a copy</a></li>
                                    <li><a href='#' data-toggle='modal' data-target='#modal'>Edit</a></li>
                                    <li><a href='#' class='list-group-item popup-list-item' data-toggle='modal' data-target='#modal' ng-click='setupToDelete(book._id);'>Delete</a></li>
                                </ul>
                                </div>
                            </div>
                        </header>
                        <section class="panel-body">
                            <div class="row">
                                <div class="col-sm-7 col-md-7 col-lg-7">
                                    <h4>Title</h4>
                                    <p>{{book.title}}</p>
                                    <h4>Author</h4>
                                    <p>{{book.title}}</p>
                                </div>
                                <div class="col-sm-5 col-md-5 col-lg-5 ">
                                    <figure> <img class="img-thumbnail center-block cover-image" src="{{book.cover_photo}}" onclick="setupModalImage(this);" alt="Book´s cover" width="150" data-toggle="modal" data-target="#modal" />
                                        <figcaption>
                                            <h4>Cover photo</h4></figcaption>
                                    </figure>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <h4>Description</h4>
                                    <p>{{cutAbstract(book.description)}}</p>
                                </div>
                            </div>
                            <br>
                            <button class="btn btn-primary btn-block" data-toggle="modal" data-target="#modal" ng-click="showBookInfo(book);"> MORE INFO </button>
                        </section>
                    </div>
                </article>
            </div>
        </main>
    </div>
    <div class="modal fade" id="modal" role="dialog">
        <div class="modal-dialog modal-lg">
            <!-- Modal content-->
            <div id="copyModal" class="modal-content hide">
                <div class="modal-header">
                    <h3>Copy registration of <em  id="copy-modal-title"></em></h3> </div>
                <form id="copy-form">
                    <div class="modal-body center-block">
                        <input id="book-id" name="book" hidden="true" />
                        <div class="form-group row">
                            <div class="col-xs-6">
                                <label for="edition">Edition</label>
                                <select id="edition" name="edition" class="form-control">
                                    <option value="First">First</option>
                                    <option value="Second">Second</option>
                                    <option value="Third">Third</option>
                                    <option value="Fourth">Fourth</option>
                                    <option value="Fifth">Fifth</option>
                                    <option value="Sixth">Sixth</option>
                                    <option value="Seventh">Seventh</option>
                                    <option value="Eighth">Eighth</option>
                                    <option value="Ninth">Ninth</option>
                                    <option value="Tenth">Tenth</option>
                                </select>
                            </div>
                            <div class="col-xs-6">
                                <label for="status">Status</label>
                                <select id="status" name="state" class="form-control">
                                    <option value="ok">Ok</option>
                                    <option value="damaged">Damaged</option>
                                    <option value="incomplete">Incomplete</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-xs-6">
                                <label for="pages">Pages</label>
                                <input id="pages" name="pages" class="form-control" type="number" min="20" value="20" /> </div>
                            <div class="col-xs-6">
                                <label for="language">Language</label>
                                <select id="language" name="language" class="form-control">
                                    <option value="English">English</option>
                                    <option value="Spanish">Spanish</option>
                                    <option value="Mandarin">Mandarin</option>
                                    <option value="Hindi"> Hindi </option>
                                    <option value="German"> German </option>
                                    <option value="Russian">Russian</option>
                                    <option value="Japanese">Japanese</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <input type="reset" class="btn btn-warning " value="cancel" data-dismiss="modal" />
                        <input type="submit" class="btn btn-success " value="send" /> </div>
                </form>
            </div>
            <div id="deleteModal" class="modal-content hide">
                <div class="modal-body center-block">
                    <div class="modal-header">
                        <h3>Confirm the operation</h3> </div>
                    <div class="modal-body center-block">
                        <h4>Are you sure about delete this book?</h4> </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default" data-dismiss="modal">NO, STOP THIS!</button>
                    <button class="btn btn-warning" onclick="deleteBook();">YES, I'M SURE</button>
                </div>
            </div>
            <div id="coverModal" class="modal-content hide">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body center-block">
                    <figure> <img id="img-modal" class="img-responsive" src="" width="" />
                        <figcaption>Cover photo</figcaption>
                    </figure>
                </div>
            </div>
            <div id="waitModal" class="modal-content hide container-fluid">
                <div class="modal-body ">
                    <div class="modal-body row">
                        <div class="col-xs-6">
                            <h3>Wait just a little...</h3></div>
                        <div class="col-xs-6">
                            <div class="loading-ic ic-large ic-spin center-block"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="responseModal" class="modal-content hide">
                <div class="modal-body center-block">
                    <div class="modal-header">
                        <h3 id="response-title"></h3> </div>
                    <div class="modal-body center-block">
                        <h4 id="response-message"></h4> </div>
                    <div class="modal-footer">
                        <button class="btn btn-info" data-dismiss="modal">OK</button>
                    </div>
                </div>
            </div>
            <div id="bookInfoModal" class="modal-content hide">
                <div class="modal-body center-block">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Book Information</h4> </div>
                    <div class="modal-body center-block">
                        <div class="row">
                            <div id="book-info" class="col-sm-6">
                                <h4>ISBN</h4>
                                <p ng-bind="bookInfo.isbn"></p>
                                <h4>Title</h4>
                                <p ng-bind="bookInfo.title"></p>
                                <h4>Author</h4>
                                <p ng-bind="bookInfo.author"></p>
                                <h4>Abstract</h4>
                                <p ng-bind="bookInfo.description">The abstract of the book</p>
                                <h4>Categories</h4>
                                <p><h4 ng-repeat="cat in bookInfo.categories"><span class="label label-primary" ng-bind="cat.name"></span></h4></p>
                            </div>
                            <div id="book-copies" class="col-sm-6">
                                <h3>Book copies</h3>
                                <table id="copies-table" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Status</th>
                                            <th>Pages</th>
                                            <th>Edition</th>
                                            <th>Language</th>
                                            <th>Pub. Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="copy in bookInfo.copies"> 
                                            <td ng-bind="copy.state"></td>
                                            <td ng-bind="copy.pages"></td>
                                            <td ng-bind="copy.edition"></td>
                                            <td ng-bind="copy.language"></td>
                                            <td ng-bind="copy.publication_date"></td>
                                        </tr> 
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="editBook" class="modal-content hide">
                <div class="modal-body center-block">
                    <div class="col-xs-12">
                        <form id="book-form" class="panel panel-default" enctype="multipart/form-data">
                            <header class="panel-heading form-header">
                                <div class="row">
                                    <div class="col-xs-7 col-sm-10"> New Book</div>
                                    <div class="col-xs-5 col-sm-2">
                                        <input type="submit" class="btn btn-default btn-traslucid btn-lg pull-right" value="SAVE" /> </div>
                                </div>
                            </header>
                            <div class="panel-body row">
                                <fieldset class="col-sm-6 col-md-8">
                                    <legend>Book Data</legend>
                                    <div class="form-group form-group-lg">
                                        <div class="col-xs-12  col-md-4">
                                            <label for="isbn">ISBN:</label>
                                            <input type="text" class="form-control" id="isbn" name="isbn" required> </div>
                                        <div class="col-xs-12 col-md-8">
                                            <label for="title">Title:</label>
                                            <input type="text" class="form-control" id="title" name="title" required> </div>
                                        <div class="col-xs-12">
                                            <label for="author">Author:</label>
                                            <input type="text" class="form-control" id="author" name="author" required> </div>
                                        <div class="col-xs-12">
                                            <label for="category">Category:</label>
                                            <select id="category-select" class="form-control selectpicker" name="categories" data-live-search="true" title="Choose the book categories" required multiple> </select>
                                        </div>
                                        <div class="col-xs-12">
                                            <label for="description">Description:</label>
                                            <textarea class="form-control" id="description" name="description" rows="8"></textarea>
                                        </div>
                                    </div>
                                </fieldset>
                                <fieldset class="col-sm-6 col-md-4">
                                    <legend>Cover Photo</legend>
                                    <div class="form-group">
                                        <figure> <img id="preview-img" class="img-responsive center-block" src="/public/images/covers/generic-book-cover.jpg" alt="Book´s cover" width="60%" /> </figure>
                                        <br/>
                                        <label class="btn btn-default btn-lg btn-block">
                                            <input id="upload-input" name="cover" style="display:none;" type="file" accept="image/*"> <span class="glyphicon glyphicon-upload"></span> UPLOAD </label>
                                    </div>
                                </fieldset>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div></div>
</body>

</html>